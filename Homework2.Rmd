---
title: "Homework 2"

---


```{r}
Traveldata <- read.csv("Sept11Travel.csv")
Traveldata 
```

1. Plot the pre-event AIR time series. What time series components appear?
#Answer: There is an upward linear trend and seasonality. 

```{r}
#pre-event time series for Air 

Air_pre911.ts <- ts(Traveldata$Air,  start = c(1990, 1), end = c(2004, 4), frequency = 12)
Air_pre911.plot <- plot(Air_pre911.ts, ylab = "Air Passenger Miles(Millions)", type="l", bty="l",  main = "Airline Revenue Passenger Miles before 9/11")
```

2. The following figure shows a time plot of the seasonally adjusted pre-September-11 AIR series. Which of the following methods would be adequate for forecasting the series shown in the figure?
#Answer: Linear Regression Model with trend
        
        

3. Specify a linear regression model for the AIR series that would produce a seasonally adjusted series similar to the one shown in the figure below, with multiplicative seasonality. What is the outcome variable? What are the predictors?
#Answer: Outcome variable: Seasonally adjusted Time 
#Predictors:  trend and season

```{r}

```


4. Run the regression model from (3). Remember to use only pre-event data.
       What can we learn from the statistical insignificance of the coefficients for October and September?
#the statistical insignificance of the coefficients indicate that autocorrelation exists inthe dataset
The predicted value for January 1990 was 44212445.07
The residual is 44.21244507 – 35.153577 = 9.058868067 air revenue persenger miles

The actual value of AIR (air revenue passenger miles) in January 1990 was 35.153577 billion. What is the residual for this month, using the regression model? Report the residual in terms of air revenue passenger miles.
```{r}
#Adding trend or season or Trend+season
AirMulti.lm <- tslm(Adjusted_Air_multiplicative.ts ~ trend)
summary(AirMulti.lm)

AirMulti.lm.season <- tslm(Adjusted_Air_multiplicative.ts ~ season)
summary(AirMulti.lm.season)

AirMulti.lm.seasonAndTrend <- tslm(Adjusted_Air_multiplicative.ts ~ trend+season)
summary(AirMulti.lm.seasonAndTrend)
plot(AirMulti.lm.seasonAndTrend$residuals)
AirMulti.lm.seasonAndTrend$residuals
```



5.Create an ACF (autocorrelation) plot of the regression residuals.
    What does the ACF plot tell us about the regression model’s forecasts?
#Here, we see that there exists trend component as well as a seasonal component. On making first differentiation, it will change the trend effects and seasonal differencing will automatically control the seasonal effects
     How can this information be used to improve the model?
#Using this information, the model can be improved by removing the variables that have high autocorrelation
```{r}
Acf(AirMulti.lm.seasonAndTrend$residuals, lag.max = 12, main="")
#partial autocorrelation
Pacf(AirMulti.lm.seasonAndTrend$residuals, lag.max = 12, main="")
  
```



6.  Fit linear regression models to Air, Rail, and to Auto with additive seasonality and an appropriate trend. For Air and Rail, fit a linear trend. For Rail, use a quadratic trend. Remember to use only pre-event data. Once the models are estimated, use them to forecast each of the three post-event series.
        For each series (Air, Rail, Auto), plot the complete pre-event and post-event actual series overlayed with the predicted series.


```{r}
#adding linear trend for Air,rail and Vehicle
# adding linear trend for Air,rail and Vehicle
Air.lm <- tslm(Adjusted_Air_Additive.ts ~ trend)
summary(Air.lm)

Rail.lm <- tslm(Adjusted_Rail.ts ~ trend)
summary(Rail.lm)

Vehicle.lm <- tslm(Adjusted_Vehicle.ts ~ trend)
summary(Rail.lm)


# fitting Quadratic trend for Rail
Rail.lm <- tslm(Adjusted_Rail.ts ~ trend + I(trend^2))
summary(Rail.lm)

```


```{r}
#  generate the naive and seasonal naive forecasts
Airnaive.pred <- forecast::naive(Adjusted_Air_Additive.ts, h = 36)
Airsnaive.pred <- forecast::snaive(Adjusted_Air_Additive.ts, h = 36)
Airnaive.pred
Airsnaive.pred

Railnaive.pred <- forecast::naive(Adjusted_Rail.ts, h = 36)
Railsnaive.pred <- forecast::snaive(Adjusted_Rail.ts, h = 36)
Railnaive.pred
Railsnaive.pred

Vehiclenaive.pred <- forecast::naive(Adjusted_Vehicle.ts, h = 36)
Vehiclesnaive.pred <- forecast::snaive(Adjusted_Vehicle.ts, h = 36)
Vehiclenaive.pred
Vehiclesnaive.pred
```


```{r}
# plot forecasts and actuals in the training and validation sets
plot(AirTravel.ts,  ylab = "Air Travel", xlab = "Time", bty = "l", xaxt = "n", xlim = c(1990,2005), main = "") 
axis(1, at = seq(1990, 2005, 1), labels = format(seq(1990, 2005, 1)))
lines(Airnaive.pred$mean, lwd = 2, col = "blue", lty = 1)
lines(Airsnaive.pred$mean, lwd = 2, col = "red", lty = 1)
lines(c(2004.70 - 3, 2004.70 - 3), c(0, 700999930)) 
lines(c(2004.25, 2004.25), c(0, 700999930))
text(1994.25, 69103630, "Training")
text(2002.75, 69999990, "Validation")
text(2004.90, 69103630, "Future")
arrows(2001, 67000000, 1990, 67000000, code = 3, length = 0.1, lwd = 1,angle = 30)


plot(RailTravel.ts,  ylab = "Rail Travel", xlab = "Time", bty = "l", xaxt = "n", xlim = c(1990,2005), main = "") 
axis(1, at = seq(1990, 2005, 1), labels = format(seq(1990, 2005, 1)))
lines(Railnaive.pred$mean, lwd = 2, col = "blue", lty = 1)
lines(Railsnaive.pred$mean, lwd = 2, col = "red", lty = 1)
lines(c(2004.70 - 3, 2004.70 - 3), c(0, 804013874)) 
lines(c(2004.25, 2004.25), c(0, 804013874))
text(1996, 664013874, "Training")
text(2002.75, 664013874, "Validation")
text(2004.90, 664013874, "Future")
#arrows(2001, 630000000, 1990, 630000000, code = 3, length = 0.1, lwd = 1,angle = 30)
#arrows(2004.5 - 3, 2450, 2004, 2450, code = 3, length = 0.1, lwd = 1,angle = 30)
#arrows(2004.5, 2450, 2006, 2450, code = 3, length = 0.1, lwd = 1, angle = 30)
  
  plot(VehicleTravel.ts,  ylab = "Vehicle Travel", xlab = "Time", bty = "l", xaxt = "n", xlim = c(1990,2005), main = "") 
  axis(1, at = seq(1990, 2005, 1), labels = format(seq(1990, 2005, 1)))
  lines(Vehiclenaive.pred$mean, lwd = 2, col = "blue", lty = 1)
  lines(Vehiclesnaive.pred$mean, lwd = 2, col = "red", lty = 1)
  lines(c(2004.70 - 3, 2004.70 - 3), c(0, 350)) 
  lines(c(2004.25, 2004.25), c(0, 270))
  text(1994.25, 240, "Training")
  text(2002.75, 255, "Validation")
  text(2004.90, 240, "Future")
arrows(2001, 67000000, 1990, 67000000, code = 3, length = 0.1, lwd = 1,angle = 30)
```


  What can be said about the effect of the September 11 terrorist attack on the three modes of transportation? Discuss the magnitude of the effect, its time span, and any other relevant aspects.
#It is found that the September 2011 terrorist attack has a great impact on the Air, Rail and Auto. The magnitude of the effect is very high and it reduces the significance of the model

